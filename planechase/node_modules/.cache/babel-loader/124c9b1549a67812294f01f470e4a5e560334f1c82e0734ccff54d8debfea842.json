{"ast":null,"code":"import { getMappedPlane, makeFullPlaneUrl } from \"./utils\";\nconst dataSource = 'dhuber-cluster-0';\nconst database = 'planechase';\nconst sessionCollection = 'sessions';\nfunction getHeaders() {\n  const headers = new Headers();\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('Access-Control-Request-Headers', '*');\n  headers.append('Access-Control-Allow-Origin', '*');\n  headers.append('api-key', 'kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO');\n}\nfunction getHeadersJson() {\n  return {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n    'Access-Control-Request-Headers': '*',\n    'Access-Control-Allow-Origin': '*',\n    'api-key': 'kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO'\n  };\n}\nexport async function getSession(sessionCode, activePlane, imageMap) {\n  //   curl --location 'https://us-east-1.aws.data.mongodb-api.com/app/data-napyt/endpoint/data/v1/action/findOne' \\\n  // --header 'Content-Type: application/json' \\\n  // --header 'Access-Control-Request-Headers: *' \\\n  // --header 'api-key: kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO' \\\n  // --header 'Accept: application/json' \\\n  // --data '{\n  //       \"dataSource\": \"dhuber-cluster-0\",\n  //       \"database\": \"planechase\",\n  //       \"collection\": \"sessions\",\n  //       \"filter\": { \"_id\": \"ABCD\"  }\n  //   }'\n\n  console.log('getting session ' + sessionCode);\n  return await getExistingSession(sessionCode, imageMap);\n}\nexport async function makeNewSession(activePlane, planarDeck, imageMap) {\n  const options = {\n    method: 'POST',\n    headers: getHeadersJson,\n    body: JSON.stringify(planarDeck)\n  };\n  return await fetch(`/planechaseSessions/makeSession/${activePlane.id}`, options).then(response => response.json()).then(data => {\n    console.log(data[0]);\n    const plane = getMappedPlane(data[1].fields, imageMap);\n    return {\n      code: data[0].pk,\n      plane: plane,\n      rollCost: data[0].fields.rollCost,\n      rollResult: data[0].fields.rollResult,\n      planarDeck: data[0].fields.planeDeck\n    };\n  }).catch(error => console.log('error making session: ' + error));\n}\nasync function getExistingSession(sessionCode, imageMap) {\n  // fetch('https://us-east-1.aws.data.mongodb-api.com/app/data-napyt/endpoint/data/v1/action/findOne', requestOptions)\n  //   .then(response => response.json())\n  //   .then(data => sessionData = data)\n  //   .catch(error => console.error(error));\n  // console.log('session: ' + sessionData);\n\n  return await fetch(`/planechaseSessions/getSession/${sessionCode}`).then(response => response.json()).then(data => {\n    console.log(data[0]);\n    const plane = getMappedPlane(data[1].fields, imageMap);\n    return {\n      code: data[0].pk,\n      plane: plane,\n      rollCost: data[0].fields.rollCost,\n      rollResult: data[0].fields.rollResult\n    };\n  }).catch(error => console.log('error getting sessions: ' + error));\n}\nexport async function getAllPlanes() {\n  console.log('getAllPlanes');\n  return await fetch(`/planechaseSessions/getWebcamFriendlyPlanes`).then(response => response.json()).catch(error => console.log('error getting all planes: ' + error));\n}\nexport async function setPlaneById(sessionCode, planeId) {\n  console.log('planeId: ' + planeId);\n  return await fetch(`/planechaseSessions/setPlane/${sessionCode}/${planeId}`).then(response => response.json()).catch(error => console.log('error setting the plane: ' + error));\n}\nexport async function setRollInfo(sessionCode, rollCost, rollResult) {\n  console.log(`Roll cost: ${rollCost}, result: ${rollResult}`);\n  return await fetch(`/planechaseSessions/setRollInfo/${sessionCode}/${rollCost}/${rollResult}`).then(response => response.json()).catch(error => console.log('error setting the roll info: ' + error));\n}","map":{"version":3,"names":["getMappedPlane","makeFullPlaneUrl","dataSource","database","sessionCollection","getHeaders","headers","Headers","append","getHeadersJson","getSession","sessionCode","activePlane","imageMap","console","log","getExistingSession","makeNewSession","planarDeck","options","method","body","JSON","stringify","fetch","id","then","response","json","data","plane","fields","code","pk","rollCost","rollResult","planeDeck","catch","error","getAllPlanes","setPlaneById","planeId","setRollInfo"],"sources":["/Users/danhuber/Desktop/development/planechase-new/planechase/src/tools/mongoApi.js"],"sourcesContent":["import { getMappedPlane, makeFullPlaneUrl } from \"./utils\";\n\nconst dataSource = 'dhuber-cluster-0';\nconst database = 'planechase';\nconst sessionCollection = 'sessions';\n\nfunction getHeaders() {\n  const headers = new Headers();\n  headers.append('Content-Type', 'application/json');\n  headers.append('Accept', 'application/json');\n  headers.append('Access-Control-Request-Headers', '*');\n  headers.append('Access-Control-Allow-Origin', '*');\n  headers.append('api-key', 'kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO');\n}\n\nfunction getHeadersJson() {\n  return {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n    'Access-Control-Request-Headers': '*',\n    'Access-Control-Allow-Origin': '*',\n    'api-key': 'kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO'\n  }\n}\n\nexport async function getSession(sessionCode, activePlane, imageMap) {\n//   curl --location 'https://us-east-1.aws.data.mongodb-api.com/app/data-napyt/endpoint/data/v1/action/findOne' \\\n// --header 'Content-Type: application/json' \\\n// --header 'Access-Control-Request-Headers: *' \\\n// --header 'api-key: kqhoHk09XphZcWMeBlGUOgDSXwvQDDkkn5mRXreTwyV6afivwZYiTnit6JSt7JyO' \\\n// --header 'Accept: application/json' \\\n// --data '{\n//       \"dataSource\": \"dhuber-cluster-0\",\n//       \"database\": \"planechase\",\n//       \"collection\": \"sessions\",\n//       \"filter\": { \"_id\": \"ABCD\"  }\n//   }'\n\n  console.log('getting session ' + sessionCode);\n  return await getExistingSession(sessionCode, imageMap);\n}\n\nexport async function makeNewSession(activePlane, planarDeck, imageMap) {\n  const options = {\n    method: 'POST',\n    headers: getHeadersJson,\n    body: JSON.stringify(planarDeck)\n  };\n\n  return await fetch(`/planechaseSessions/makeSession/${activePlane.id}`, options)\n    .then(response => response.json())\n    .then(data => {\n      console.log(data[0]);\n      const plane = getMappedPlane(data[1].fields, imageMap);\n      return {\n        code: data[0].pk,\n        plane: plane,\n        rollCost: data[0].fields.rollCost,\n        rollResult: data[0].fields.rollResult,\n        planarDeck: data[0].fields.planeDeck\n      };\n    })\n    .catch(error => console.log('error making session: ' + error));\n}\n\nasync function getExistingSession(sessionCode, imageMap) {\n  // fetch('https://us-east-1.aws.data.mongodb-api.com/app/data-napyt/endpoint/data/v1/action/findOne', requestOptions)\n  //   .then(response => response.json())\n  //   .then(data => sessionData = data)\n  //   .catch(error => console.error(error));\n  // console.log('session: ' + sessionData);\n\n  return await fetch(`/planechaseSessions/getSession/${sessionCode}`)\n    .then(response => response.json())\n    .then(data => {\n      console.log(data[0]);\n      const plane = getMappedPlane(data[1].fields, imageMap);\n      return {\n        code: data[0].pk,\n        plane: plane,\n        rollCost: data[0].fields.rollCost,\n        rollResult: data[0].fields.rollResult\n      };\n    })\n    .catch(error => console.log('error getting sessions: ' + error));\n}\n\nexport async function getAllPlanes() {\n  console.log('getAllPlanes');\n  return await fetch(`/planechaseSessions/getWebcamFriendlyPlanes`)\n    .then(response => response.json())\n    .catch(error => console.log('error getting all planes: ' + error));\n}\n\nexport async function setPlaneById(sessionCode, planeId) {\n  console.log('planeId: ' + planeId);\n  return await fetch(`/planechaseSessions/setPlane/${sessionCode}/${planeId}`)\n    .then(response => response.json())\n    .catch(error => console.log('error setting the plane: ' + error));\n}\n\nexport async function setRollInfo(sessionCode, rollCost, rollResult) {\n  console.log(`Roll cost: ${rollCost}, result: ${rollResult}`);\n  return await fetch(`/planechaseSessions/setRollInfo/${sessionCode}/${rollCost}/${rollResult}`)\n    .then(response => response.json())\n    .catch(error => console.log('error setting the roll info: ' + error));\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}